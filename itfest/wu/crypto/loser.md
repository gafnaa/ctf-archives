# loser

THE WINNER TAKES IT ALL (takes it all) THE LOSER HAS TO FALL (has to fall) IT'S SIMPLE AND IT'S PLAINNNN (it's so plain) WHY SHOULD I COMPLAINNNNNNNNNNNNN? (Why complain?)

## Solusi

dikasi file ini

```py
from Crypto.Util.number import getPrime, bytes_to_long, inverse
import random
flag = b"{REDACTED}"
m = bytes_to_long(flag)
p = getPrime(512)
q = getPrime(512)
n = p * q
phi = (p - 1) * (q - 1)
bound = int(n**0.25) // 9
d = random.randint(1, bound)
e = inverse(d, phi)

c = pow(m, e, n)
print(f"n = {n}")
print(f"e = {e}")
print(f"c = {c}")

# n = 89787030506065130961691162071640526600900999390584025212438925224025790603611803382829753068415346194234828370090019894570631854213526738959075845323641396992779684246140921916969995998524966331677826308240784253900402839696559634844433120207219192581406844937467164340274829287625334053624143689525778359709
# e = 78414849045753317001474661129566353123251170206391116478237107623188417230393458001339962470374215604580509944423543229370632169599310737503281734289658222149831403630560114043316194722860423296465127893812713737817586748113044704795154776454211283944941022901398078512913453948778037459939002169103520634737
# c = 28424875679745923307037567727592670601346363160221100104216433590381260168703389829862412346264944920071174922277887743147710764479351398887241102512955924690428015732687220248183521183242833560649557991823604461526326432672076056284792856034282817714326100029292387663121249805363038470118403595582254303652
```

jika dilihat ini merupakan rsa chall.

intinya gitu lah, ini solpernya

```py
from fractions import Fraction
from Crypto.Util.number import long_to_bytes
import gmpy2

# given values
n = 89787030506065130961691162071640526600900999390584025212438925224025790603611803382829753068415346194234828370090019894570631854213526738959075845323641396992779684246140921916969995998524966331677826308240784253900402839696559634844433120207219192581406844937467164340274829287625334053624143689525778359709
e = 78414849045753317001474661129566353123251170206391116478237107623188417230393458001339962470374215604580509944423543229370632169599310737503281734289658222149831403630560114043316194722860423296465127893812713737817586748113044704795154776454211283944941022901398078512913453948778037459939002169103520634737
c = 28424875679745923307037567727592670601346363160221100104216433590381260168703389829862412346264944920071174922277887743147710764479351398887241102512955924690428015732687220248183521183242833560649557991823604461526326432672076056284792856034282817714326100029292387663121249805363038470118403595582254303652

# continued fraction
def continued_fraction(n, d):
    while d:
        a = n // d
        yield a
        n, d = d, n - a * d

# convergents
def convergents(cf):
    p, q = 0, 1
    p1, q1 = 1, 0
    for a in cf:
        p2 = a * p1 + p
        q2 = a * q1 + q
        yield (p2, q2)
        p, q = p1, q1
        p1, q1 = p2, q2

# Wiener's attack
for k, d in convergents(continued_fraction(e, n)):
    if k == 0:
        continue
    # Check if d is correct
    phi_candidate = (e * d - 1) // k
    if (e * d - 1) % k != 0:
        continue

    # Solve for the roots of x^2 - (n - phi + 1)x + n = 0
    a = 1
    b = -(n - phi_candidate + 1)
    c_val = n

    discriminant = b * b - 4 * a * c_val
    if discriminant >= 0:
        sqrt_d = gmpy2.isqrt(discriminant)
        if sqrt_d * sqrt_d == discriminant:
            # valid p and q found
            m = pow(c, d, n)
            print("Flag:", long_to_bytes(m))
            break
```
tinggal run bang

```
PS D:\CTF\itfest> python -u "d:\CTF\itfest\files\solve.py"
Flag: b'ITFEST25{when_yh_jadi_my_kisah}'
```

## Flag
    ITFEST25{when_yh_jadi_my_kisah}